<div class="page-header">
  <h1 class="page-title">Admins</h1>
  <nav class="page-nav">
    <div class="dropdown">
      <%= link_to "Add new admin",
                  new_email_authentication_invitation_path,
                  class: "btn btn-sm btn-primary" %>
    </div>
  </nav>
</div>

<%= bootstrap_form_with(url: admins_path, method: :get, class: "mt-3", local: true) do |form| %>
  <div class="row mb-5">
    <div class="col col-12 col-md-11 mb-2">
      <%= form.search_field :search_query,
                            hide_label: true,
                            prepend: "<i class='fa fa-search'></i>".html_safe,
                            placeholder: "Search by name or email...",
                            value: params[:search_query],
                            autofocus: params[:search_query].blank?,
                            tabindex: 2,
                            wrapper: false %>
    </div>
    <div class="col col-12 col-md-1 mb-2 pl-md-0">
      <%= form.submit "Search", class: "btn btn-success btn-block", wrapper: false, tabindex: 3 %>
    </div>
  </div>
<% end %>

<% if @admins.present? %>
  <h2>Search Results</h2>
  <% @admins.each do |admin| %>
    <div class="card" title="<%= admin.email %>">
      <div class="row">
        <div class="col col-md-6">
          <h5>
            <%= link_to admin.full_name, admin_path(admin) %>
          </h5>
          <div class="mt-2"><%= admin.email %></div>
        </div>
        <div class="col-md-6 text-right">
          <% if admin.invited_to_sign_up? %>
            <span class="badge badge-success badge-pill mr-4 mt-1" style="font-size: 90%; font-weight: normal;">Invite sent</span>
          <% end %>

          <% if policy([:manage, :admin, admin]).edit? %>
            <%= link_to 'Edit', edit_admin_path(admin), class: "btn btn-sm btn-outline-primary" %>
          <% end %>

          <% if policy([:manage, :admin, admin]).destroy? %>
            <%= link_to(admin_path(admin), method: :delete, data: { confirm: "Are you sure you want to delete #{admin.email}?" }, class: "btn btn-sm btn-outline-danger") do %>
              <i class="fas fa-trash-alt"></i>
            <% end %>
          <% end %>
        </div>
      </div>
    </div>
  <% end %>
<% else %>
  <div class="row mt-3 d-flex justify-content-center">
    <div class="no-search-results">
      <div class="d-flex justify-content-center pb-3">
        <i class="fa fa-search"></i>
      </div>
      <span>There are no admins named "<%= params[:search_query] %>"</span>
    </div>
  </div>
<% end %>
